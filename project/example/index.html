<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: April 27, 2023 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.0f229d4b7ebad1917a9a357cba2effab.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  


























  
  
  






  <meta name="author" content="Xupeng Wang(PhD Applicant)" />





  

<meta name="description" content="A brief introduction to the Complex Table Parsing Project, its version iteration contents, and related technical analysis." />



<link rel="alternate" hreflang="en-us" href="https://wangxupeng.github.io/project/example/" />
<link rel="canonical" href="https://wangxupeng.github.io/project/example/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  






<meta property="twitter:card" content="summary_large_image" />

  <meta property="twitter:site" content="@wowchemy" />
  <meta property="twitter:creator" content="@wowchemy" />
<meta property="twitter:image" content="https://wangxupeng.github.io/project/example/featured.jpg" />
<meta property="og:site_name" content="Wang Xupeng&#39;s Personal Homepage" />
<meta property="og:url" content="https://wangxupeng.github.io/project/example/" />
<meta property="og:title" content="Complex Table Parsing Project | Wang Xupeng&#39;s Personal Homepage" />
<meta property="og:description" content="A brief introduction to the Complex Table Parsing Project, its version iteration contents, and related technical analysis." /><meta property="og:image" content="https://wangxupeng.github.io/project/example/featured.jpg" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2023-04-27T00:00:00&#43;00:00"
    />
  
  
    <meta property="article:modified_time" content="2023-04-27T00:00:00&#43;00:00">
  






    









<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://wangxupeng.github.io/project/example/"
  },
  "headline": "Complex Table Parsing Project",
  
  "image": [
    "https://wangxupeng.github.io/project/example/featured.jpg"
  ],
  
  "datePublished": "2023-04-27T00:00:00Z",
  "dateModified": "2023-04-27T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Xupeng Wang(PhD Applicant)"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Wang Xupeng's Personal Homepage",
    "logo": {
      "@type": "ImageObject",
      "url": "https://wangxupeng.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "A brief introduction to the Complex Table Parsing Project, its version iteration contents, and related technical analysis."
}
</script>

  

  




  
  
  

  
  

  


  
  <title>Complex Table Parsing Project | Wang Xupeng&#39;s Personal Homepage</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="e8f8d235e8e7f2efd912bfe865363fc3" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Wang Xupeng&#39;s Personal Homepage</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Wang Xupeng&#39;s Personal Homepage</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article article-project">

  






















  
  


<div class="article-container pt-3">
  <h1>Complex Table Parsing Project</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Apr 27, 2023
  </span>
  

  

  

  
  
  
  

  
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 405px;">
  <div style="position: relative">
    <img src="/project/example/featured_hu3d03a01dcc18bc5be0e67db3d8d209a6_224363_720x2500_fit_q75_h2_lanczos.webp" width="720" height="405" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/WXMCj7c9NHc" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h2 id="the-first-version-of-table-recognition">The first version of table recognition.</h2>
<!--在上述视频中，展示了我所设计的表格识别的最初版本。该方法主要是基于DBnet实现的，在图像中检测出需要提取的表格部分的文字坐标，并根据这些坐标将对应文字图像切分出来。随后，将这些文字图像输入CRNN进行文字识别。最后，通过一些后处理操作，将表格的样式还原出来。在使用这个系统时，需要输入表格的行数和列数，以便于在前端进行展示。-->
<p>The above video demonstrates the initial version of my designed table recognition system (The content in this video was produced in 2021, but the technical implementation was achieved around 2018). The approach mainly relies on the implementation of DBnet[1] to detect the coordinates of the text within the table that needs to be extracted from the image. Based on these coordinates, the corresponding text images are sliced out. Subsequently, these text images are input into CRNN[2] for text recognition. Finally, some post-processing operations are applied to restore the style of the table. When using this system, the number of rows and columns of the table need to be inputted for display purposes in the frontend.</p>
<!--在别的版本里，由于客户的需求，我们也做了一点改进，客户需要在鼠标点击文字的时候能在图片上高亮显示文字。于是在CRNN[2]后处理上做了一些改进。代码如下：-->
<p>In other versions,  we made some improvements based on the customer&rsquo;s needs. The customer required that the text should be highlighted on the image when the mouse clicks on it. Therefore, some modifications were made to the post-processing of CRNN [2]. The code is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">total_axis</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># create an empty list to store the coordinates of each character recognized in the image</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="c1"># convert the image into a numpy array</span>
</span></span><span class="line"><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># set the index to 0</span>
</span></span><span class="line"><span class="cl"><span class="n">color</span><span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># set the color to blue</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">color</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">box</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boxes</span><span class="p">):</span> <span class="c1"># loop through each detected text box</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># if index &gt; 1:</span>
</span></span><span class="line"><span class="cl">    <span class="n">degree</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">box</span><span class="p">)</span> <span class="c1"># calculate the degree of rotation, width, height, and center coordinates of the box</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">xy_rotate_box</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">degree</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="c1"># get the four corner points of the rotated bounding box</span>
</span></span><span class="line"><span class="cl">    <span class="n">cx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">])</span> <span class="c1"># calculate the x-coordinate of the center point</span>
</span></span><span class="line"><span class="cl">    <span class="n">cy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y4</span><span class="p">])</span> <span class="c1"># calculate the y-coordinate of the center point</span>
</span></span><span class="line"><span class="cl"><span class="c1">### --------------------------------------------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">    <span class="n">partImg</span><span class="p">,</span> <span class="n">newW</span><span class="p">,</span> <span class="n">newH</span> <span class="o">=</span> <span class="n">rotate_cut_img</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">im</span><span class="p">),</span> <span class="n">degree</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">leftAdjust</span><span class="p">,</span> <span class="n">rightAdjust</span><span class="p">,</span> <span class="n">alph</span><span class="p">)</span> <span class="c1"># rotate and crop the image according to the bounding box</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">raw_step_</span> <span class="o">=</span> <span class="n">crnnOcr</span><span class="p">(</span><span class="n">partImg</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">))</span> <span class="c1"># recognize the text in the cropped image using CRNN model</span>
</span></span><span class="line"><span class="cl">    <span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="c1"># convert the image back to a numpy array</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(len(total))</span>
</span></span><span class="line"><span class="cl">    <span class="n">time_step</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">total</span><span class="p">)</span> <span class="c1"># count the number of recognized characters</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_step</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1"># calculate the initial x-coordinate position of the character</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># set the initial step to 0</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(total)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">axis</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># create an empty list to store the coordinates of each character in the cropped image</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">time_step</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">total</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&#34;ç&#34;</span> <span class="ow">and</span> <span class="n">total</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">!=</span> <span class="n">total</span><span class="p">[</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span> <span class="c1"># if the predicted character is not overlapping with the previous one and is not a specific character</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># print(total[l])</span>
</span></span><span class="line"><span class="cl">            <span class="n">axis</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">start_step</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">raw_step_</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">raw_step_</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>  <span class="c1"># left_top_x</span>
</span></span><span class="line"><span class="cl">                         <span class="nb">int</span><span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>  <span class="c1"># left_top_y</span>
</span></span><span class="line"><span class="cl">                         <span class="nb">int</span><span class="p">(</span><span class="n">start_step</span> <span class="o">+</span> <span class="n">raw_step_</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">raw_step_</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>  <span class="c1"># right_bottom_x</span>
</span></span><span class="line"><span class="cl">                         <span class="nb">int</span><span class="p">(</span><span class="n">cy</span> <span class="o">+</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)])</span>  <span class="c1"># right_bottom_y</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">start_step</span> <span class="o">+=</span> <span class="n">raw_step_</span> <span class="c1"># update the x-coordinate position for the next character</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1"># increment the step by 1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">start_step</span> <span class="o">+=</span> <span class="n">raw_step_</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Adjust the position of each character if the predicted text is longer than 2</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Get the coordinates of the current character</span>
</span></span><span class="line"><span class="cl">            <span class="n">left_top_x</span> <span class="o">=</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">right_bottom_x</span> <span class="o">=</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># Adjust the position of the first character</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># If the right boundary of the current character overlaps with the left boundary of the next character</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">right_bottom_x</span> <span class="o">&gt;</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Calculate the average position between the two characters</span>
</span></span><span class="line"><span class="cl">                    <span class="n">r_avg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">right_bottom_x</span> <span class="o">+</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Update the right boundary of the current character</span>
</span></span><span class="line"><span class="cl">                    <span class="n">axis</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_avg</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Update the left boundary of the next character</span>
</span></span><span class="line"><span class="cl">                    <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_avg</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># Adjust the position of the last character</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># If the left boundary of the current character overlaps with the right boundary of the previous character</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">left_top_x</span> <span class="o">&lt;</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Calculate the average position between the two characters</span>
</span></span><span class="line"><span class="cl">                    <span class="n">l_avg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">left_top_x</span> <span class="o">+</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Update the left boundary of the current character</span>
</span></span><span class="line"><span class="cl">                    <span class="n">axis</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_avg</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Update the right boundary of the previous character</span>
</span></span><span class="line"><span class="cl">                    <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_avg</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># Adjust the position of the middle characters</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># If the left boundary of the current character overlaps with the right boundary of the previous character</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">left_top_x</span> <span class="o">&lt;</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Calculate the average position between the two characters</span>
</span></span><span class="line"><span class="cl">                    <span class="n">l_avg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">left_top_x</span> <span class="o">+</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Update the left boundary of the current character</span>
</span></span><span class="line"><span class="cl">                    <span class="n">axis</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_avg</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Update the right boundary of the previous character</span>
</span></span><span class="line"><span class="cl">                    <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_avg</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="c1"># If the right boundary of the current character overlaps with the left boundary of the next character</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">right_bottom_x</span> <span class="o">&gt;</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Calculate the average position between the two characters</span>
</span></span><span class="line"><span class="cl">                    <span class="n">r_avg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">right_bottom_x</span> <span class="o">+</span> <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Update the right boundary of the current character</span>
</span></span><span class="line"><span class="cl">                    <span class="n">axis</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_avg</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># Update the left boundary of the next character</span>
</span></span><span class="line"><span class="cl">                    <span class="n">axis</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_avg</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># Draw a rectangle around the current character</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># cv2.rectangle(img=im,</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#               pt1=(axis[index][0], axis[index][1]),</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#               pt2=(axis[index][2], axis[index][3]),</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#               color=(255, 0, 0),</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#               thickness=1)</span>
</span></span><span class="line"><span class="cl">   
</span></span></code></pre></div><p>Due to the code being too long, I only outputted cases where the length of the recognized characters by CRNN[2] is greater than 2.</p>
<p>The code first loops through each detected text box in the image and rotates and crops the image to align with the bounding box. Then, it uses a CRNN[2] model to recognize the text in the cropped image. It also counts the number of recognized characters and calculates the initial x-coordinate position of the character.</p>
<p>Next, the code creates an empty list to store the coordinates of each character in the cropped image. It then loops through each recognized character and checks if it overlaps with the previous one or if it is a specific character. If it does not overlap and is not a specific character, the code calculates the coordinates of the character and updates the x-coordinate position for the next character.</p>
<p>If the predicted text is longer than two characters, the code adjusts the position of each character to account for overlap with adjacent characters. Specifically, the code updates the left or right boundary of the current or adjacent characters to ensure that there is no overlap. Finally, the code draws a rectangle around each recognized character.</p>
<p><strong>This project, along with related OCR technology, helped my first company Shenzhen Huayun Zhongsheng Technology win the project from the Guangdong Provincial Prosecutor&rsquo;s Office.</strong> Looking back at my code from 2018, I realize how immature it was at the time and how much room for optimization there was.</p>
<hr>
<p><strong>Reference</strong>:
[1] Liao, M., Zhu, X., &amp; Shi, B. (2020). Real-time Scene Text Detection with Differentiable Binarization. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR) (pp. 12065-12074).</p>
<p>[2] Shi, B., Bai, X., &amp; Yao, C. (2017). An end-to-end trainable neural network for image-based sequence recognition and its application to scene text recognition. IEEE Transactions on Pattern Analysis and Machine Intelligence, 39(11), 2298-2304.&quot;</p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/deep-learning/">Deep Learning</a>
  
</div>













  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://wangxupeng.github.io/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hub0c01464ce3326802983320515815174_1708455_270x270_fill_q75_lanczos_center.jpg" alt="Xupeng Wang(PhD Applicant)"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://wangxupeng.github.io/">Xupeng Wang(PhD Applicant)</a></h5>
      <h6 class="card-subtitle">The head of Big Data Center</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/wangxupeng" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/xupeng-wang-68b749226/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/uploads/resume.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


















    <div class="project-related-pages content-widget-hr">
      
      

      
      
      

      
      
      

      
      
      
    </div>
  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2023 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.46271ef31da3f018e9cd1b59300aa265.js"></script>




  

  
  

  













  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":true}</script>



  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>









  
  


<script src="/en/js/wowchemy.min.8621d706896ab6d11dd8fd7042e20931.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>


















</body>
</html>
